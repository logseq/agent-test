<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Snake</title>
  <style>
    :root {
      --bg: #101820;
      --panel: #172634;
      --grid: #22384a;
      --snake: #ffd84d;
      --head: #ffcc00;
      --food: #ff6b6b;
      --text: #f1f5f9;
      --muted: #9fb0bd;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      background: radial-gradient(circle at 20% 0%, #1c2f42 0%, var(--bg) 55%);
      color: var(--text);
      font-family: "Trebuchet MS", "Segoe UI", sans-serif;
    }

    .game-wrap {
      width: min(92vw, 540px);
      background: color-mix(in srgb, var(--panel) 90%, #000);
      border: 1px solid #2a465c;
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 18px 35px rgba(0, 0, 0, 0.35);
    }

    .hud {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      gap: 10px;
    }

    .title {
      font-size: 1.1rem;
      letter-spacing: 0.06em;
      margin: 0;
    }

    .score {
      font-weight: 700;
      color: var(--snake);
    }

    .hint {
      margin: 10px 0 0;
      font-size: 0.9rem;
      color: var(--muted);
      text-align: center;
    }

    canvas {
      display: block;
      width: 100%;
      aspect-ratio: 1;
      background:
        linear-gradient(90deg, transparent 24px, var(--grid) 24px, var(--grid) 25px, transparent 25px),
        linear-gradient(transparent 24px, var(--grid) 24px, var(--grid) 25px, transparent 25px),
        #0f1d29;
      background-size: 25px 25px;
      border-radius: 10px;
      border: 1px solid #35566f;
    }

    .overlay {
      margin-top: 10px;
      text-align: center;
      min-height: 1.4rem;
      font-weight: 700;
      color: var(--food);
    }

    @media (max-width: 520px) {
      .hint {
        font-size: 0.82rem;
      }
    }
  </style>
</head>
<body>
  <main class="game-wrap">
    <div class="hud">
      <h1 class="title">SNAKE</h1>
      <div class="score">Score: <span id="score">0</span></div>
    </div>
    <canvas id="board" width="500" height="500" aria-label="Snake game board"></canvas>
    <div id="overlay" class="overlay"></div>
    <p class="hint">Use Arrow Keys or WASD. Press Space to restart after game over.</p>
  </main>

  <script>
    const canvas = document.getElementById("board");
    const ctx = canvas.getContext("2d");
    const scoreEl = document.getElementById("score");
    const overlayEl = document.getElementById("overlay");

    const gridCount = 20;
    const tileSize = canvas.width / gridCount;
    const tickMs = 110;

    let snake;
    let direction;
    let nextDirection;
    let food;
    let score;
    let running;
    let timerId;

    function resetGame() {
      snake = [
        { x: 9, y: 10 },
        { x: 8, y: 10 },
        { x: 7, y: 10 },
      ];
      direction = { x: 1, y: 0 };
      nextDirection = { x: 1, y: 0 };
      food = spawnFood();
      score = 0;
      running = true;
      scoreEl.textContent = "0";
      overlayEl.textContent = "";
      draw();
    }

    function spawnFood() {
      while (true) {
        const candidate = {
          x: Math.floor(Math.random() * gridCount),
          y: Math.floor(Math.random() * gridCount),
        };
        const onSnake = snake?.some((segment) => segment.x === candidate.x && segment.y === candidate.y);
        if (!onSnake) return candidate;
      }
    }

    function sameDirection(a, b) {
      return a.x === b.x && a.y === b.y;
    }

    function setDirection(x, y) {
      const proposed = { x, y };
      const reverse = proposed.x === -direction.x && proposed.y === -direction.y;
      if (!reverse && !sameDirection(proposed, nextDirection)) {
        nextDirection = proposed;
      }
    }

    function endGame() {
      running = false;
      overlayEl.textContent = "Game Over - press Space to restart";
    }

    function step() {
      if (!running) return;

      direction = nextDirection;
      const head = snake[0];
      const newHead = { x: head.x + direction.x, y: head.y + direction.y };
      const ateFood = newHead.x === food.x && newHead.y === food.y;

      const hitWall =
        newHead.x < 0 || newHead.x >= gridCount || newHead.y < 0 || newHead.y >= gridCount;
      const bodyToCheck = ateFood ? snake : snake.slice(0, -1);
      const hitSelf = bodyToCheck.some((segment) => segment.x === newHead.x && segment.y === newHead.y);

      if (hitWall || hitSelf) {
        endGame();
        draw();
        return;
      }

      snake.unshift(newHead);

      if (ateFood) {
        score += 1;
        scoreEl.textContent = String(score);
        food = spawnFood();
      } else {
        snake.pop();
      }

      draw();
    }

    function drawTile(x, y, color) {
      const padding = 2;
      ctx.fillStyle = color;
      ctx.fillRect(x * tileSize + padding, y * tileSize + padding, tileSize - padding * 2, tileSize - padding * 2);
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      drawTile(food.x, food.y, getComputedStyle(document.documentElement).getPropertyValue("--food"));

      snake.forEach((segment, index) => {
        const color = index === 0
          ? getComputedStyle(document.documentElement).getPropertyValue("--head")
          : getComputedStyle(document.documentElement).getPropertyValue("--snake");
        drawTile(segment.x, segment.y, color);
      });
    }

    function startLoop() {
      clearInterval(timerId);
      timerId = setInterval(step, tickMs);
    }

    document.addEventListener("keydown", (event) => {
      switch (event.key) {
        case "ArrowUp":
        case "w":
        case "W":
          setDirection(0, -1);
          break;
        case "ArrowDown":
        case "s":
        case "S":
          setDirection(0, 1);
          break;
        case "ArrowLeft":
        case "a":
        case "A":
          setDirection(-1, 0);
          break;
        case "ArrowRight":
        case "d":
        case "D":
          setDirection(1, 0);
          break;
        case " ":
          if (!running) resetGame();
          break;
      }
    });

    resetGame();
    startLoop();
  </script>
</body>
</html>
